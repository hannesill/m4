{
  "id": "sql-query-evaluation-root",
  "requirements": "SQL Query Evaluation",
  "sequential": false,
  "sub_tasks": [
    {
      "id": "patient-cohort-construction",
      "requirements": "Patient Cohort Construction",
      "weight": 3,
      "sequential": false,
      "sub_tasks": [
        {
          "id": "gender-selection",
          "requirements": "Gender Selection: The query must filter for female patients by using `p.gender = 'F'`.",
          "sequential": false,
          "critical": true,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "age-range-selection",
          "requirements": "Age Range Selection: The query must filter patients to the 70-80 age range using `p.anchor_age BETWEEN 70 AND 80`.",
          "sequential": false,
          "critical": true,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "surgical-inpatient-identification",
          "requirements": "Surgical Inpatient Identification: The query must correctly identify surgical admissions by filtering the `services` table for relevant `curr_service` values ('SURG', 'CSURG', 'NSURG', 'TSURG', 'VSURG', 'ORTHO').",
          "sequential": false,
          "critical": true,
          "scoring": "1/0",
          "sub_tasks": []
        }
      ]
    },
    {
      "id": "database-integration",
      "requirements": "Database Integration",
      "weight": 3,
      "sequential": true,
      "sub_tasks": [
        {
          "id": "patient-admission-join",
          "requirements": "Patient-Admission Join: The query must correctly join the `patients` and `admissions` tables on `subject_id` to link demographic data with hospital stay information.",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "surgical-cohort-join",
          "requirements": "Surgical Cohort Join: The query must join the filtered patient base with the identified surgical admissions using `hadm_id` to form the final cohort.",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        }
      ]
    },
    {
      "id": "clinical-analytics",
      "requirements": "Clinical Analytics",
      "weight": 2,
      "sequential": true,
      "sub_tasks": [
        {
          "id": "length-of-stay-calculation",
          "requirements": "Length of Stay Calculation: The query must accurately calculate the length of stay in days using `DATETIME_DIFF(a.dischtime, a.admittime, DAY)`.",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "los-threshold-flagging",
          "requirements": "LOS Threshold Flagging: The query must correctly create binary flags for LOS >= 7 days and LOS >= 14 days using CASE statements.",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "discharge-stratification",
          "requirements": "Discharge Stratification: The query must use a CASE statement to correctly stratify patients into 'Discharged Home', 'Discharged to Facility', and 'In-Hospital Mortality' based on `discharge_location` and `hospital_expire_flag`.",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        }
      ]
    },
    {
      "id": "final-aggregation",
      "requirements": "Final Aggregation",
      "weight": 2,
      "sequential": true,
      "sub_tasks": [
        {
          "id": "grouping-logic",
          "requirements": "Grouping Logic: The query must group the results by the created `discharge_category` to stratify the output correctly.",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "proportion-calculation",
          "requirements": "Proportion Calculation: The query must correctly calculate the proportions for each LOS threshold by dividing the sum of the LOS flags by the total count within each group and multiplying by 100.",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "output-formatting",
          "requirements": "Output Formatting: The final proportion values must be rounded to two decimal places using `ROUND(..., 2)`. The query should also filter out 'Other' discharge categories.",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        }
      ]
    }
  ]
}
