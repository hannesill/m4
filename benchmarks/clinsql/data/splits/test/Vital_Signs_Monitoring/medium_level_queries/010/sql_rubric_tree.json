{
  "id": "sql-query-evaluation-root",
  "requirements": "SQL Query Evaluation",
  "sequential": false,
  "sub_tasks": [
    {
      "id": "patient-cohort-construction",
      "requirements": "Patient Cohort Construction",
      "weight": 3,
      "sequential": false,
      "sub_tasks": [
        {
          "id": "gender-selection",
          "requirements": "Gender Selection: The query must filter for female patients by checking p.gender = 'F'.",
          "sequential": false,
          "critical": true,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "age-range-selection",
          "requirements": "Age Range Selection: The query must correctly calculate the age at ICU admission and filter for patients between 77 and 87 years old.",
          "sequential": false,
          "critical": true,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "icu-stay-selection",
          "requirements": "ICU Stay Selection: The query must correctly identify ICU stays as the unit of analysis.",
          "sequential": false,
          "critical": true,
          "scoring": "1/0",
          "sub_tasks": []
        }
      ]
    },
    {
      "id": "medical-concept-implementation",
      "requirements": "Medical Concept Implementation for Systolic Blood Pressure",
      "weight": 3,
      "sequential": true,
      "sub_tasks": [
        {
          "id": "sbp-code-selection",
          "requirements": "Systolic Blood Pressure (SBP) Code Selection: The query must filter for relevant SBP measurements using the correct itemids (e.g., 220050, 51).",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "temporal-filter",
          "requirements": "Temporal Filter: The query must filter SBP measurements to include only those recorded within the first 48 hours of the ICU stay.",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "value-range-validation",
          "requirements": "Value Range Validation: The query should apply a plausible range filter (e.g., BETWEEN 40 AND 300) on SBP values to exclude erroneous data.",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        }
      ]
    },
    {
      "id": "database-integration",
      "requirements": "Database Integration",
      "weight": 3,
      "sequential": false,
      "sub_tasks": [
        {
          "id": "table-join-logic",
          "requirements": "Table Join Logic: The query must correctly join patients, admissions, icustays, and chartevents tables to link patient demographics to their ICU measurements.",
          "sequential": false,
          "critical": true,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "key-matching",
          "requirements": "Key Matching: The query must use the correct keys (subject_id, hadm_id, stay_id) for joining the tables.",
          "sequential": false,
          "critical": true,
          "scoring": "1/0",
          "sub_tasks": []
        }
      ]
    },
    {
      "id": "clinical-analytics",
      "requirements": "Clinical Analytics and Percentile Calculation",
      "weight": 2,
      "sequential": true,
      "sub_tasks": [
        {
          "id": "per-stay-aggregation",
          "requirements": "Per-Stay Aggregation: The query must first calculate the average SBP for each individual ICU stay by grouping by stay_id.",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "percentile-rank-calculation",
          "requirements": "Percentile Rank Calculation: The query must correctly calculate the percentile rank of the target value (160 mmHg) by dividing the count of stays at or below the target by the total number of stays in the cohort.",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        },
        {
          "id": "statistical-distribution-analysis",
          "requirements": "Statistical Distribution Analysis: The query should use an appropriate function (e.g., APPROX_QUANTILES or PERCENTILE_CONT) to calculate the distribution of average SBP values across the cohort.",
          "sequential": false,
          "critical": false,
          "scoring": "1/0",
          "sub_tasks": []
        }
      ]
    }
  ]
}
